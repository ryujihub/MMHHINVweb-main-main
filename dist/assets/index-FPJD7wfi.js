import{a as w,c as D,a3 as kt,e as p,f as v,E as t,g as X,k as ot,L as U,x as N,P as L,a5 as Y,I as l,F as at,A as z,a6 as Et,G as B,j as W,Z as Nt,o as vt,w as _t,q as dt,a7 as j,h as Ft,T as Bt,a4 as Wt}from"./@vue-G05DReI1.js";import{u as Ot,c as Ht,a as zt}from"./vue-router-pxgJhgyj.js";import{d as At,c as Qt}from"./pinia-DpHCTaCg.js";import"./firebase-Bgg19n3A.js";import{i as Gt,g as jt,a as Yt,o as Pt,b as Kt,d as nt,s as Zt,q as lt,c as J,w as ct,e as wt,l as Jt,f as $t,h as bt,j as ut,k as et,m as Xt,n as te,G as ee,p as se,t as oe,u as ne,v as ae,x as gt,y as le}from"./@firebase-C7HEDqO6.js";import{N as Dt,l as xt,I as Z,d as re,O as ie,P as de,Q as ue}from"./date-fns-C7w5FKmJ.js";import{Q as ce}from"./@vuepic-aTRiOs3A.js";import{C as Ct}from"./chart.js-DWZv7t3w.js";import"./chartjs-adapter-date-fns-XRg4a92b.js";import{E as ve}from"./jspdf-Bymh3kmP.js";import{a as St}from"./jspdf-autotable-CtA5BUKo.js";import{s as pe}from"./vue-toastification-CPUxlChf.js";import"./tslib-BGVaTf34.js";import"./idb-BXWtuYvb.js";import"./@babel-DMP3hiBh.js";import"./@kurkle-D8fDXNIl.js";import"./fflate-BO5HMHBV.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))n(d);new MutationObserver(d=>{for(const f of d)if(f.type==="childList")for(const h of f.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function m(d){const f={};return d.integrity&&(f.integrity=d.integrity),d.referrerPolicy&&(f.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?f.credentials="include":d.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function n(d){if(d.ep)return;d.ep=!0;const f=m(d);fetch(d.href,f)}})();const me={apiKey:"AIzaSyABZw1Jk2WdOFqmp2ww8lYV0DBdcVR50GI",authDomain:"hardwareinventory-65123.firebaseapp.com",projectId:"hardwareinventory-65123",storageBucket:"hardwareinventory-65123.firebasestorage.app",messagingSenderId:"1006715726520",appId:"1:1006715726520:web:13897a36fb527e8194224d",measurementId:"G-Y4ZHE3GBN5"};let ht,tt,E;try{ht=Gt(me),console.log("Firebase initialized successfully"),tt=jt(ht),console.log("Firebase Authentication initialized"),E=Yt(ht),console.log("Firestore initialized")}catch(O){throw console.error("Firebase initialization error:",O),new Error("Failed to initialize Firebase services")}const pt=At("auth",()=>{const O=w(null),o=w("staff"),m=w(!0),n=D(()=>o.value==="admin"),d=D(()=>o.value==="staff"),f=()=>{Pt(tt,async A=>{m.value=!0;try{A?(O.value=A,console.log("Auth state changed: User logged in",A.email),await h(A.uid)):(O.value=null,o.value="staff",console.log("Auth state changed: User logged out or no user"))}finally{m.value=!1}m.value=!1})},h=async A=>{try{const S=await Kt(nt(E,"users",A));if(S.exists()){const q=S.data().role;o.value=q==="admin"||q==="staff"?q:"staff",console.log("User role fetched:",o.value)}else console.log("User document not found for uid:",A),o.value="staff"}catch(S){console.error("Error fetching user role:",S),o.value="staff"}};return{user:O,userRole:o,loading:m,isAdmin:n,isStaff:d,initializeAuth:f,canAccess:A=>{const S=["staff","admin"],q=S.indexOf(o.value),P=S.indexOf(A);return q>=P}}}),st=(O,o)=>{const m=O.__vccOpts||O;for(const[n,d]of o)m[n]=d;return m},fe={name:"App",setup(){const O=Ot(),o=pt(),m=w(""),n=w(0),d=w(""),f=w(""),h=w(!1),C=w(!1),A=w([]),{user:S,userRole:q}=Nt(o),P=()=>{h.value=!h.value},k=()=>{C.value=!C.value},$=async()=>{try{await Zt(tt),O.push("/login")}catch(M){console.error("Logout error:",M)}},V=M=>{if(!M)return"";const R=M.toDate?M.toDate():new Date(M);return Dt(R,{addSuffix:!0})};vt(()=>{o.initializeAuth(),Pt(tt,M=>{M?(d.value=M.displayName||"User",f.value=M.photoURL||"https://ui-avatars.com/api/?name="+encodeURIComponent(d.value)+"&background=random",F(M.uid)):(d.value="",f.value="")}),document.addEventListener("click",M=>{const R=document.querySelector(".user-profile"),G=document.querySelector(".notifications-btn");R&&!R.contains(M.target)&&(h.value=!1),G&&!G.contains(M.target)&&(C.value=!1)})});const F=async M=>{try{const R=lt(J(E,"notifications"),ct("userId","==",M),ct("read","==",!1));wt(R,G=>{A.value=G.docs.map(K=>({id:K.id,...K.data()})),n.value=A.value.length})}catch(R){console.error("Error fetching user data:",R)}};return{searchQuery:m,unreadNotifications:n,username:d,userAvatar:f,userRole:q,user:S,notifications:A,showUserMenu:h,showNotifications:C,toggleUserMenu:P,toggleNotifications:k,handleLogout:$,formatTime:V}}},ye={class:"app"},ge={class:"app-wrapper"},he={class:"sidebar"},ke={class:"nav-links"},_e={class:"main-content"},we={class:"top-bar"},$e={class:"search-bar"},be={class:"user-menu"},Ce={key:0,class:"notification-badge"},Se={class:"avatar"},Oe={class:"user-info"},Ae={class:"user-name"},Pe={class:"user-role"},De={class:"dropdown-header"},xe={class:"avatar-large"},Me={class:"user-info"},qe={class:"user-email"},Ie={class:"user-role"},Te={key:0,class:"no-notifications"},Le={key:1,class:"notifications-list"},Re={class:"notification-content"},Ue={class:"notification-text"},Ve={class:"notification-time"};function Ee(O,o,m,n,d,f){var A,S,q,P;const h=kt("router-link"),C=kt("router-view");return v(),p("div",ye,[t("div",ge,[t("nav",he,[o[9]||(o[9]=t("div",{class:"sidebar-header"},[t("h1",null,"MMH Hardware"),t("p",{class:"subtitle"},"Management System")],-1)),t("div",ke,[X(h,{to:"/",class:"nav-link",exact:""},{default:ot(()=>o[4]||(o[4]=[t("i",{class:"fas fa-chart-line"},null,-1),U(" Dashboard ")])),_:1}),X(h,{to:"/catalog",class:"nav-link"},{default:ot(()=>o[5]||(o[5]=[t("i",{class:"fas fa-boxes"},null,-1),U(" Products ")])),_:1}),X(h,{to:"/orders/new",class:"nav-link"},{default:ot(()=>o[6]||(o[6]=[t("i",{class:"fas fa-cart-plus"},null,-1),U(" New Order ")])),_:1}),X(h,{to:"/orders",class:"nav-link"},{default:ot(()=>o[7]||(o[7]=[t("i",{class:"fas fa-clipboard-list"},null,-1),U(" Orders ")])),_:1}),X(h,{to:"/reports",class:"nav-link"},{default:ot(()=>o[8]||(o[8]=[t("i",{class:"fas fa-chart-bar"},null,-1),U(" Reports ")])),_:1})])]),t("main",_e,[t("header",we,[t("div",$e,[o[10]||(o[10]=t("i",{class:"fas fa-search"},null,-1)),L(t("input",{type:"text",placeholder:"Search products, orders, reports...","onUpdate:modelValue":o[0]||(o[0]=k=>n.searchQuery=k)},null,512),[[Y,n.searchQuery]])]),t("div",be,[t("button",{class:"notifications-btn",onClick:o[1]||(o[1]=(...k)=>n.toggleNotifications&&n.toggleNotifications(...k))},[o[11]||(o[11]=t("i",{class:"fas fa-bell"},null,-1)),n.unreadNotifications?(v(),p("span",Ce,l(n.unreadNotifications),1)):N("",!0)]),t("div",{class:"user-profile",onClick:o[2]||(o[2]=at((...k)=>n.toggleUserMenu&&n.toggleUserMenu(...k),["stop"]))},[t("div",Se,l((A=n.user)!=null&&A.email?n.user.email[0].toUpperCase():"U"),1),t("div",Oe,[t("span",Ae,l(((S=n.user)==null?void 0:S.email)||"User"),1),t("span",Pe,l(n.userRole||"Guest"),1)]),t("i",{class:z(["fas fa-chevron-down",{rotate:n.showUserMenu}])},null,2)]),n.showUserMenu?(v(),p("div",{key:0,class:z(["user-dropdown",{show:n.showUserMenu}])},[t("div",De,[t("div",xe,l((q=n.user)!=null&&q.email?n.user.email[0].toUpperCase():"U"),1),t("div",Me,[t("p",qe,l(((P=n.user)==null?void 0:P.email)||"Guest User"),1),t("p",Ie,l(n.userRole||"No Role Assigned"),1)])]),o[13]||(o[13]=Et('<div class="dropdown-divider"></div><div class="dropdown-menu-items"><a href="#" class="menu-item"><i class="fas fa-user"></i> Profile </a><a href="#" class="menu-item"><i class="fas fa-cog"></i> Settings </a></div><div class="dropdown-divider"></div>',3)),t("button",{onClick:o[3]||(o[3]=(...k)=>n.handleLogout&&n.handleLogout(...k)),class:"logout-btn"},o[12]||(o[12]=[t("i",{class:"fas fa-sign-out-alt"},null,-1),t("span",null,"Logout",-1)]))],2)):N("",!0)])]),X(C),n.showNotifications?(v(),p("div",{key:0,class:z(["notifications-dropdown",{show:n.showNotifications}])},[n.notifications.length===0?(v(),p("div",Te," No new notifications ")):(v(),p("div",Le,[(v(!0),p(B,null,W(n.notifications,k=>(v(),p("div",{key:k.id,class:z(["notification-item",{unread:!k.read}])},[t("div",Re,[t("p",Ue,l(k.message),1),t("span",Ve,l(k.timestamp),1)])],2))),128))]))],2)):N("",!0)])])])}const Ne=st(fe,[["render",Ee]]),mt=At("inventory",()=>{const O=w([]),o=w([]),m=w([]),n=w([]),d=w([]),f=w(!1),h=w(["cement","lumber","tools","paint","electrical","plumbing"]),C=10,A=D(()=>O.value.length),S=D(()=>o.value.length),q=D(()=>m.value.length),P=D(()=>m.value.reduce((e,a)=>e+a.total,0)),k=()=>{const e=lt(J(E,"inventory"));wt(e,c=>{O.value=c.docs.map(I=>({id:I.id,...I.data()})),V()});const a=lt(J(E,"orders"),$t("createdAt","desc"),Jt(100));wt(a,c=>{m.value=c.docs.map(I=>({id:I.id,...I.data()}))})},$=e=>_t(o,a=>{e(a)}),V=()=>{o.value=O.value.filter(e=>e.currentStock>0&&e.currentStock<=C),o.value.forEach(e=>{M({type:"low_stock",title:"Low Stock Alert",message:`${e.name} - only ${e.currentStock} left in stock`,severity:"warning"})})},F=async(e="day")=>{try{f.value=!0;const a=e==="week"?new Date(Date.now()-7*24*60*60*1e3):xt(new Date),c=lt(J(E,"orders"),ct("createdAt",">=",a),$t("createdAt","desc")),Q=(await bt(c)).docs.map(y=>({id:y.id,...y.data()})),g={};Q.forEach(y=>{var b;(b=y.items)==null||b.forEach(T=>{g[T.productId]=(g[T.productId]||0)+T.quantity})});const r=Object.entries(g).sort(([,y],[,b])=>b-y).slice(0,5).map(([y])=>y);n.value=O.value.filter(y=>r.includes(y.id)).map(y=>({...y,quantitySold:g[y.id]}))}catch(a){console.error("Error fetching top selling items:",a)}finally{f.value=!1}},M=e=>{d.value.unshift({id:Date.now(),timestamp:new Date,read:!1,...e})},R=async(e,a,c)=>{try{await ut(J(E,"alerts"),{productId:e,type:a,message:c,createdAt:et(),isRead:!1})}catch(I){console.error("Error creating stock alert:",I)}};return{inventory:O,lowStockItems:o,dailyOrders:m,topSellingItems:n,notifications:d,loading:f,categories:h,totalProducts:A,getLowStockCount:S,getDailyOrdersCount:q,getDailyOrdersTotal:P,initializeInventoryListener:k,updateStockAlerts:V,onLowStockItems:$,processOrder:async e=>{const a=Xt(E);try{for(const c of e){const I=nt(E,"inventory",c.id),Q=O.value.find(r=>r.id===c.id);if(!Q||Q.currentStock<c.quantity)throw new Error(`Insufficient stock for ${c.name}`);a.update(I,{currentStock:te(-c.quantity),lastUpdated:et()});const g=Q.currentStock-c.quantity;g<=C&&await R(c.id,"low_stock",`${c.name} is running low (${g} remaining)`)}await a.commit()}catch(c){throw console.error("Error processing order:",c),c}},getSalesByPeriod:(e,a)=>O.value.map(c=>({...c,sales:Math.floor(Math.random()*100)})),getProfitLoss:(e,a)=>{const c=O.value.reduce((Q,g)=>Q+g.price*(g.sold||0),0),I=O.value.reduce((Q,g)=>Q+g.cost*(g.sold||0),0);return{revenue:c,cost:I,profit:c-I,margin:c>0?(c-I)/c*100:0}},createStockAlert:R,fetchTopSellingItems:F}}),Fe={class:"dashboard"},Be={key:0,class:"auth-message"},We={key:1,class:"dashboard-container"},He={class:"dashboard-header"},ze={class:"date-filter"},Qe=["onClick"],Ge={class:"stats-grid"},je={class:"stat-card"},Ye={class:"stat-info"},Ke={class:"stat-value"},Ze={class:"stat-amount"},Je={key:0,class:"stat-card warning"},Xe={class:"stat-info"},ts={class:"stat-value"},es={class:"stat-card"},ss={class:"stat-info"},os={class:"stat-value"},ns={class:"stat-icon"},as={key:0,class:"notification-badge"},ls={class:"stat-info"},rs={class:"stat-value"},is={class:"stat-change"},ds={class:"section-grid"},us={class:"section-card"},cs={class:"items-list"},vs={class:"item-info"},ps={class:"item-name"},ms={class:"item-category"},fs={class:"item-stats"},ys={class:"item-quantity"},gs={key:0,class:"section-card warning"},hs={class:"items-list"},ks={class:"item-info"},_s={class:"item-name"},ws={class:"item-category"},$s={class:"item-stats"},bs={class:"item-stock warning"},Cs={key:0,class:"notifications-panel"},Ss={class:"panel-header"},Os={class:"notifications-list"},As=["onClick"],Ps={class:"notification-icon"},Ds={class:"notification-content"},xs={class:"notification-time"},Ms={__name:"DashboardNew",setup(O){const o=pt(),m=mt(),n=w("Today"),d=w(!1),{LOW_STOCK_THRESHOLD:f}=m,h=D(()=>o.user),C=D(()=>m.getDailyOrdersCount),A=D(()=>m.getDailyOrdersTotal),S=D(()=>m.getLowStockCount),q=D(()=>m.lowStockItems),P=D(()=>m.topSellingItems),k=D(()=>m.notifications),$=D(()=>m.dailyOrders.filter(_=>_.status==="pending").length),V=D(()=>k.value.filter(_=>!_.read).length),F=async _=>{n.value=_,await m.fetchTopSellingItems(_.toLowerCase())},M=_=>_.toLocaleString("en-PH",{style:"currency",currency:"PHP"}),R=_=>Dt(_,{addSuffix:!0}),G=_=>{const e={low_stock:"fas fa-exclamation-triangle",order:"fas fa-shopping-cart",alert:"fas fa-bell",default:"fas fa-info-circle"};return e[_]||e.default},K=_=>{m.markNotificationAsRead(_)};return vt(async()=>{h.value&&(m.initializeInventoryListener(),await m.fetchTopSellingItems("day"))}),(_,e)=>{const a=kt("router-link");return v(),p("div",Fe,[h.value?(v(),p("div",We,[t("div",He,[e[4]||(e[4]=t("div",{class:"header-content"},[t("h1",null,"Staff Dashboard"),t("p",{class:"subtitle"},"Overview of your hardware inventory")],-1)),t("div",ze,[(v(),p(B,null,W(["Today","Week"],c=>t("button",{key:c,class:z(["filter-btn",{active:n.value===c}]),onClick:I=>F(c)},l(c),11,Qe)),64))])]),t("div",Ge,[t("div",je,[e[6]||(e[6]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-shopping-cart"})],-1)),t("div",Ye,[e[5]||(e[5]=t("h3",null,"Today's Orders",-1)),t("p",Ke,l(C.value),1),t("span",Ze,"₱"+l(M(A.value)),1)])]),S.value>0?(v(),p("div",Je,[e[9]||(e[9]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-exclamation-triangle"})],-1)),t("div",Xe,[e[7]||(e[7]=t("h3",null,"Low Stock Items",-1)),t("p",ts,l(S.value),1),e[8]||(e[8]=t("span",{class:"stat-change"},"Requires attention",-1))])])):N("",!0),t("div",es,[e[12]||(e[12]=t("div",{class:"stat-icon"},[t("i",{class:"fas fa-clock"})],-1)),t("div",ss,[e[10]||(e[10]=t("h3",null,"Pending Orders",-1)),t("p",os,l($.value),1),e[11]||(e[11]=t("span",{class:"stat-change"},"Awaiting processing",-1))])]),t("div",{class:"stat-card",onClick:e[0]||(e[0]=c=>d.value=!0)},[t("div",ns,[e[13]||(e[13]=t("i",{class:"fas fa-bell"},null,-1)),V.value?(v(),p("span",as,l(V.value),1)):N("",!0)]),t("div",ls,[e[14]||(e[14]=t("h3",null,"Notifications",-1)),t("p",rs,l(k.value.length),1),t("span",is,l(V.value)+" unread",1)])])]),t("div",ds,[t("div",us,[e[15]||(e[15]=t("h3",null,"Most Ordered Items",-1)),t("div",cs,[(v(!0),p(B,null,W(P.value,c=>(v(),p("div",{key:c.id,class:"item-row"},[t("div",vs,[t("span",ps,l(c.name),1),t("span",ms,l(c.category),1)]),t("div",fs,[t("span",ys,l(c.quantitySold)+" sold",1),t("span",{class:z(["item-stock",{"low-stock":c.currentStock<=dt(f)}])},l(c.currentStock)+" in stock ",3)])]))),128))])]),q.value.length>0?(v(),p("div",gs,[e[16]||(e[16]=t("h3",null,"Low Stock Warnings",-1)),t("div",hs,[(v(!0),p(B,null,W(q.value,c=>(v(),p("div",{key:c.id,class:"item-row"},[t("div",ks,[t("span",_s,l(c.name),1),t("span",ws,l(c.category),1)]),t("div",$s,[t("span",bs," Only "+l(c.currentStock)+" left ",1)])]))),128))])])):N("",!0)]),d.value?(v(),p("div",Cs,[t("div",Ss,[e[18]||(e[18]=t("h3",null,"Notifications",-1)),t("button",{class:"close-btn",onClick:e[1]||(e[1]=c=>d.value=!1)},e[17]||(e[17]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",Os,[(v(!0),p(B,null,W(k.value,c=>(v(),p("div",{key:c.id,class:z(["notification-item",{unread:!c.read}]),onClick:I=>K(c.id)},[t("div",Ps,[t("i",{class:z(G(c.type))},null,2)]),t("div",Ds,[t("h4",null,l(c.title),1),t("p",null,l(c.message),1),t("span",xs,l(R(c.timestamp)),1)])],10,As))),128))])])):N("",!0)])):(v(),p("div",Be,[e[3]||(e[3]=t("p",null,"Please log in to view the dashboard",-1)),X(a,{to:"/login",class:"login-btn"},{default:ot(()=>e[2]||(e[2]=[U("Login")])),_:1})]))])}}},qs=st(Ms,[["__scopeId","data-v-6e4269ac"]]),Is={setup(){const O=w(!0),o=w(""),m=w(""),n=w("staff"),d=w(""),f=Ot();return{isLogin:O,email:o,password:m,role:n,error:d,login:async()=>{d.value="";try{await ae(tt,o.value,m.value),f.push("/")}catch(S){d.value=S.message}},register:async()=>{d.value="";try{const S=await oe(tt,o.value,m.value);await ne(nt(E,"users",S.user.uid),{role:n.value}),f.push("/")}catch(S){d.value=S.message}},loginWithGoogle:async()=>{d.value="";try{const S=new ee;await se(tt,S),f.push("/")}catch(S){d.value=S.message}}}}},Ts={class:"auth-container"},Ls={key:0},Rs={key:0,class:"error"},Us={key:1},Vs={key:0,class:"error"};function Es(O,o,m,n,d,f){return v(),p("div",Ts,[n.isLogin?(v(),p("div",Ls,[o[13]||(o[13]=t("h2",null,"Login",-1)),t("form",{onSubmit:o[2]||(o[2]=at((...h)=>n.login&&n.login(...h),["prevent"]))},[L(t("input",{"onUpdate:modelValue":o[0]||(o[0]=h=>n.email=h),type:"email",placeholder:"Email",required:""},null,512),[[Y,n.email]]),L(t("input",{"onUpdate:modelValue":o[1]||(o[1]=h=>n.password=h),type:"password",placeholder:"Password",required:""},null,512),[[Y,n.password]]),o[10]||(o[10]=t("button",{type:"submit"},"Login",-1)),n.error?(v(),p("p",Rs,l(n.error),1)):N("",!0)],32),t("button",{onClick:o[3]||(o[3]=(...h)=>n.loginWithGoogle&&n.loginWithGoogle(...h)),class:"google-btn"},o[11]||(o[11]=[t("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google"},null,-1),U(" Sign in with Google ")])),t("p",null,[o[12]||(o[12]=U("Don't have an account? ")),t("a",{href:"#",onClick:o[4]||(o[4]=at(h=>n.isLogin=!1,["prevent"]))},"Register")])])):(v(),p("div",Us,[o[17]||(o[17]=t("h2",null,"Register",-1)),t("form",{onSubmit:o[8]||(o[8]=at((...h)=>n.register&&n.register(...h),["prevent"]))},[L(t("input",{"onUpdate:modelValue":o[5]||(o[5]=h=>n.email=h),type:"email",placeholder:"Email",required:""},null,512),[[Y,n.email]]),L(t("input",{"onUpdate:modelValue":o[6]||(o[6]=h=>n.password=h),type:"password",placeholder:"Password",required:""},null,512),[[Y,n.password]]),L(t("select",{"onUpdate:modelValue":o[7]||(o[7]=h=>n.role=h),required:""},o[14]||(o[14]=[t("option",{value:"staff"},"Staff",-1),t("option",{value:"admin"},"Admin",-1)]),512),[[j,n.role]]),o[15]||(o[15]=t("button",{type:"submit"},"Register",-1)),n.error?(v(),p("p",Vs,l(n.error),1)):N("",!0)],32),t("p",null,[o[16]||(o[16]=U("Already have an account? ")),t("a",{href:"#",onClick:o[9]||(o[9]=at(h=>n.isLogin=!0,["prevent"]))},"Login")])]))])}const Ns=st(Is,[["render",Es],["__scopeId","data-v-163d2a08"]]),Fs={class:"product-catalog"},Bs={class:"catalog-header"},Ws={class:"search-filters"},Hs={class:"search-box"},zs={class:"category-filter"},Qs={class:"products-grid"},Gs={class:"product-header"},js={class:"category-badge"},Ys={class:"product-details"},Ks={class:"price"},Zs={class:"product-meta"},Js={class:"meta-item"},Xs={class:"meta-item"},to={key:0,class:"stock-warning"},eo={key:0,class:"no-results"},so={__name:"ProductCatalog",setup(O){const o=mt(),m=w(""),n=w(""),{LOW_STOCK_THRESHOLD:d}=o,f=D(()=>o.categories),h=D(()=>{let P=o.inventory;if(n.value&&(P=P.filter(k=>k.category===n.value)),m.value){const k=m.value.toLowerCase();P=P.filter($=>$.name.toLowerCase().includes(k)||$.productCode.toLowerCase().includes(k)||$.category.toLowerCase().includes(k))}return P}),C=P=>P.toLocaleString("en-PH"),A=P=>P===0?"Out of Stock":P<=d?"Low Stock":"In Stock",S=P=>P===0?"fa-times-circle":P<=d?"fa-exclamation-circle":"fa-check-circle",q=()=>{};return(P,k)=>(v(),p("div",Fs,[t("div",Bs,[k[4]||(k[4]=t("h1",null,"Product Catalog",-1)),t("div",Ws,[t("div",Hs,[k[2]||(k[2]=t("i",{class:"fas fa-search"},null,-1)),L(t("input",{type:"text","onUpdate:modelValue":k[0]||(k[0]=$=>m.value=$),placeholder:"Search products...",onInput:q},null,544),[[Y,m.value]])]),t("div",zs,[L(t("select",{"onUpdate:modelValue":k[1]||(k[1]=$=>n.value=$),onChange:q},[k[3]||(k[3]=t("option",{value:""},"All Categories",-1)),(v(!0),p(B,null,W(f.value,$=>(v(),p("option",{key:$},l($),1))),128))],544),[[j,n.value]])])])]),t("div",Qs,[(v(!0),p(B,null,W(h.value,$=>(v(),p("div",{key:$.id,class:z(["product-card",{"low-stock":$.currentStock<=dt(d)}])},[t("div",Gs,[t("h3",null,l($.name),1),t("span",js,l($.category),1)]),t("div",Ys,[t("div",Ks,"₱"+l(C($.price)),1),t("div",{class:z(["stock-status",{warning:$.currentStock<=dt(d),out:$.currentStock===0}])},[t("i",{class:z(["fas",S($.currentStock)])},null,2),U(" "+l(A($.currentStock)),1)],2)]),t("div",Zs,[t("div",Js,[k[5]||(k[5]=t("i",{class:"fas fa-box"},null,-1)),t("span",null,l($.currentStock)+" in stock",1)]),t("div",Xs,[k[6]||(k[6]=t("i",{class:"fas fa-tag"},null,-1)),t("span",null,"Product Code: "+l($.productCode),1)])]),$.currentStock<=dt(d)&&$.currentStock>0?(v(),p("div",to,k[7]||(k[7]=[t("i",{class:"fas fa-exclamation-triangle"},null,-1),U(" Low Stock Alert ")]))):N("",!0)],2))),128))]),h.value.length===0?(v(),p("div",eo,k[8]||(k[8]=[t("i",{class:"fas fa-search"},null,-1),t("p",null,"No products found matching your search criteria",-1)]))):N("",!0)]))}},oo=st(so,[["__scopeId","data-v-8421ab53"]]),no={name:"ProductCard",props:{product:{type:Object,required:!0}},methods:{addToCart(){this.product.currentStock>0&&this.$emit("add-to-cart",{...this.product,quantity:1})}}},ao={class:"product-info"},lo={class:"product-name"},ro={class:"product-price"},io={class:"product-stock"};function uo(O,o,m,n,d,f){return v(),p("div",{class:"product-card",onClick:o[0]||(o[0]=(...h)=>f.addToCart&&f.addToCart(...h))},[t("div",ao,[t("h3",lo,l(m.product.name),1),t("div",ro,"₱"+l(m.product.price),1)]),t("div",io,l(m.product.currentStock)+" in stock",1)])}const co=st(no,[["render",uo],["__scopeId","data-v-7274fdbb"]]),vo={class:"order-processing"},po={class:"order-container"},mo={class:"product-selection"},fo={class:"toolbar"},yo={class:"search-bar"},go={class:"category-filter"},ho={class:"products-grid"},ko={class:"order-cart"},_o={class:"cart-header"},wo={class:"cart-actions"},$o={key:0,class:"cart-items"},bo={class:"item-left"},Co={class:"item-info"},So={class:"item-details"},Oo={class:"item-right"},Ao={class:"qty-controls"},Po=["onClick"],Do={class:"qty"},xo=["onClick"],Mo={class:"item-total"},qo=["onClick"],Io={class:"cart-summary"},To={class:"summary-line subtotal"},Lo={class:"summary-line"},Ro={class:"summary-line total"},Uo={key:1,class:"empty-cart"},Vo={class:"form-group"},Eo={class:"form-group two-col"},No={class:"form-group"},Fo={class:"form-group"},Bo={key:0,class:"mobile-bar"},Wo={class:"mobile-total"},Ho={__name:"OrderProcessing",setup(O){const o=mt(),m=pt(),n=w(""),d=w(""),f=w([]),h=w(!1),C=w({name:"",phone:"",address:"",deliveryOption:"delivery",paymentMethod:"cash"}),A=D(()=>C.value.deliveryOption==="delivery"?150:0),S=D(()=>o.categories),q=D(()=>{let _=o.inventory.map(e=>({...e,orderQuantity:1}));if(d.value&&(_=_.filter(e=>e.category===d.value)),n.value){const e=n.value.toLowerCase();_=_.filter(a=>a.name.toLowerCase().includes(e)||a.sku.toLowerCase().includes(e))}return _}),P=D(()=>f.value.reduce((_,e)=>_+e.price*e.quantity,0)),k=D(()=>P.value+A.value),$=_=>_.toLocaleString("en-PH"),V=_=>{const e=_.quantity||1,a=f.value.find(c=>c.id===_.id);a?a.quantity+=e:f.value.push({id:_.id,name:_.name,price:_.price,quantity:e}),_.orderQuantity=1},F=(_,e)=>{const a=f.value.findIndex(I=>I.id===_.id);if(a===-1)return;const c=f.value[a].quantity+e;c<=0?f.value.splice(a,1):f.value[a].quantity=c},M=_=>{const e=f.value.findIndex(a=>a.id===_.id);e!==-1&&f.value.splice(e,1)},R=()=>{f.value=[],C.value={name:"",phone:"",address:"",deliveryOption:"delivery",paymentMethod:"cash"}},G=async()=>{var _;try{const e={items:f.value,customer:C.value,subtotal:P.value,deliveryFee:A.value,total:k.value,status:"pending",createdAt:new Date,createdBy:((_=m.user)==null?void 0:_.uid)||"anonymous"},a=await ut(J(E,"orders"),e);await o.processOrder(f.value),alert(`Order #${a.id} has been created successfully!`),confirm("Would you like to print the order slip?")&&K(a.id,e)}catch(e){console.error("Error processing order:",e),alert("Failed to process order. Please try again.")}},K=(_,e)=>{try{const a=window.open("","_blank");if(!a){alert("Please allow pop-ups for this site to print order slips.");return}const c=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Order #${_}</title>
        <style>
          body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            margin: 0;
            line-height: 1.4;
          }
          .header { 
            text-align: center; 
            margin-bottom: 20px; 
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
          }
          .customer {
            margin-bottom: 20px;
          }
          .item { 
            margin: 5px 0; 
            display: flex;
            justify-content: space-between;
          }
          .total { 
            margin-top: 20px; 
            font-weight: bold;
            border-top: 1px solid #000;
            padding-top: 10px;
          }
          .summary-line {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
          }
          @media print {
            body { font-size: 12px; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>MMH Hardware</h1>
          <h2>Order Slip #${_}</h2>
          <p>${new Date().toLocaleString()}</p>
        </div>
        
        <div class="customer">
          <h3>Customer Details:</h3>
          <p><strong>Name:</strong> ${e.customer.name}</p>
          <p><strong>Phone:</strong> ${e.customer.phone}</p>
          <p><strong>Address:</strong> ${e.customer.address}</p>
          <p><strong>Delivery:</strong> ${e.customer.deliveryOption}</p>
          <p><strong>Payment:</strong> ${e.customer.paymentMethod}</p>
        </div>

        <div class="items">
          <h3>Order Items:</h3>
          ${e.items.map(I=>`
            <div class="item">
              <span>${I.name} (${I.quantity} × ₱${$(I.price)})</span>
              <span>₱${$(I.price*I.quantity)}</span>
            </div>
          `).join("")}
        </div>

        <div class="total">
          <div class="summary-line">
            <span>Subtotal:</span>
            <span>₱${$(e.subtotal)}</span>
          </div>
          <div class="summary-line">
            <span>Delivery Fee:</span>
            <span>₱${$(e.deliveryFee)}</span>
          </div>
          <div class="summary-line">
            <span><strong>Total:</strong></span>
            <span><strong>₱${$(e.total)}</strong></span>
          </div>
        </div>
      </body>
      </html>
    `;a.document.write(c),a.document.close(),a.onload=()=>{a.print()},setTimeout(()=>{a&&!a.closed&&a.print()},500)}catch(a){console.error("Error printing order slip:",a),alert("Error printing order slip. Please try again or save the order details manually.")}};return(_,e)=>(v(),p("div",vo,[e[28]||(e[28]=t("div",{class:"page-header"},[t("h1",null,"New Order"),t("p",{class:"subtitle"},"Create and process new orders")],-1)),t("div",po,[t("section",mo,[t("div",fo,[t("div",yo,[e[11]||(e[11]=t("i",{class:"fas fa-search"},null,-1)),L(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>n.value=a),placeholder:"Search products by name or category...",onInput:e[1]||(e[1]=(...a)=>_.filterProducts&&_.filterProducts(...a))},null,544),[[Y,n.value]])]),t("div",go,[L(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),onChange:e[3]||(e[3]=(...a)=>_.filterProducts&&_.filterProducts(...a)),class:"category-select"},[e[12]||(e[12]=t("option",{value:""},"All Categories",-1)),(v(!0),p(B,null,W(S.value,a=>(v(),p("option",{key:a},l(a),1))),128))],544),[[j,d.value]])])]),t("div",ho,[(v(!0),p(B,null,W(q.value,a=>(v(),Ft(co,{key:a.id,product:a,class:z({"out-of-stock":a.currentStock===0}),onAddToCart:V},null,8,["product","class"]))),128))])]),t("aside",ko,[t("div",_o,[e[13]||(e[13]=t("h2",null,"Order Cart",-1)),t("div",wo,[f.value.length?(v(),p("button",{key:0,onClick:R,class:"clear-btn"},"Clear")):N("",!0),t("button",{class:"details-btn",onClick:e[4]||(e[4]=a=>h.value=!h.value)},"Customer Details")])]),f.value.length?(v(),p("div",$o,[(v(!0),p(B,null,W(f.value,a=>(v(),p("div",{key:a.id,class:"cart-item"},[t("div",bo,[e[14]||(e[14]=t("div",{class:"item-thumb"},"📦",-1)),t("div",Co,[t("h4",null,l(a.name),1),t("div",So,"₱"+l($(a.price)),1)])]),t("div",Oo,[t("div",Ao,[t("button",{onClick:c=>F(a,-1)},"-",8,Po),t("span",Do,l(a.quantity),1),t("button",{onClick:c=>F(a,1)},"+",8,xo)]),t("div",Mo,"₱"+l($(a.price*a.quantity)),1),t("button",{onClick:c=>M(a),class:"remove-btn"},"×",8,qo)])]))),128)),t("div",Io,[t("div",To,[e[15]||(e[15]=t("span",null,"Subtotal",-1)),t("span",null,"₱"+l($(P.value)),1)]),t("div",Lo,[e[16]||(e[16]=t("span",null,"Delivery Fee",-1)),t("span",null,"₱"+l($(A.value)),1)]),t("div",Ro,[e[17]||(e[17]=t("span",null,"Total",-1)),t("span",null,"₱"+l($(k.value)),1)])])])):(v(),p("div",Uo,e[18]||(e[18]=[t("i",{class:"fas fa-shopping-cart"},null,-1),t("p",null,"Your cart is empty",-1)]))),X(Bt,{name:"slide"},{default:ot(()=>[h.value?(v(),p("form",{key:0,onSubmit:at(G,["prevent"]),class:"customer-form"},[e[26]||(e[26]=t("h3",null,"Customer Details",-1)),t("div",Vo,[e[19]||(e[19]=t("label",null,"Name",-1)),L(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=a=>C.value.name=a),required:"",placeholder:"Customer name"},null,512),[[Y,C.value.name]])]),t("div",Eo,[t("div",null,[e[20]||(e[20]=t("label",null,"Phone",-1)),L(t("input",{type:"tel","onUpdate:modelValue":e[6]||(e[6]=a=>C.value.phone=a),required:"",placeholder:"Contact number"},null,512),[[Y,C.value.phone]])]),t("div",null,[e[22]||(e[22]=t("label",null,"Delivery Option",-1)),L(t("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>C.value.deliveryOption=a),required:""},e[21]||(e[21]=[t("option",{value:"delivery"},"Delivery",-1),t("option",{value:"pickup"},"Pickup",-1)]),512),[[j,C.value.deliveryOption]])])]),t("div",No,[e[23]||(e[23]=t("label",null,"Address",-1)),L(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=a=>C.value.address=a),required:"",placeholder:"Delivery address"},null,512),[[Y,C.value.address]])]),t("div",Fo,[e[25]||(e[25]=t("label",null,"Payment Method",-1)),L(t("select",{"onUpdate:modelValue":e[9]||(e[9]=a=>C.value.paymentMethod=a),required:""},e[24]||(e[24]=[t("option",{value:"cash"},"Cash on Delivery",-1),t("option",{value:"gcash"},"GCash",-1),t("option",{value:"counter"},"Pay at Counter",-1)]),512),[[j,C.value.paymentMethod]])]),e[27]||(e[27]=t("button",{type:"submit",class:"submit-btn"},"Process Order",-1))],32)):N("",!0)]),_:1})])]),f.value.length?(v(),p("div",Bo,[t("div",Wo,"Total: ₱"+l($(k.value)),1),t("button",{class:"process-btn",onClick:e[10]||(e[10]=a=>h.value=!0)},"Checkout")])):N("",!0)]))}},zo=st(Ho,[["__scopeId","data-v-22a9a19b"]]),Qo={class:"order-management"},Go={class:"page-header"},jo={class:"header-actions"},Yo={class:"filters"},Ko={class:"search"},Zo={class:"orders-table"},Jo={class:"customer-info"},Xo={class:"phone"},tn={class:"items-summary"},en=["onUpdate:modelValue","onChange"],sn=["value"],on=["onUpdate:modelValue","onChange"],nn=["value"],an={key:1},ln={class:"action-buttons"},rn=["onClick"],dn=["onClick"],un=["onClick"],cn=["onClick"],vn={key:0,class:"modal"},pn={class:"modal-content"},mn={class:"modal-header"},fn={class:"modal-body"},yn={class:"order-details"},gn={class:"detail-section"},hn={class:"detail-section"},kn={class:"items-list"},_n={class:"item-name"},wn={class:"item-quantity"},$n={class:"item-price"},bn={class:"order-summary"},Cn={class:"summary-line"},Sn={class:"summary-line"},On={class:"summary-line total"},An={class:"order-history"},Pn={class:"history-timeline"},Dn={class:"event-icon"},xn={class:"event-details"},Mn={class:"event-description"},qn={class:"event-time"},In={key:1,class:"modal"},Tn={class:"modal-content"},Ln={class:"modal-header"},Rn={class:"modal-body"},Un={class:"form-group"},Vn={class:"modal-actions"},En={key:2,class:"modal"},Nn={class:"modal-content"},Fn={class:"modal-header"},Bn={class:"modal-body"},Wn={class:"modal-actions"},Hn={__name:"OrderManagement",setup(O){const o=pt(),m=["Pending","Processing","Completed","Cancelled"],n=w([]),d=w(null),f=w(!1),h=w(!1),C=w(""),A=w(null),S=w(null),q=w([]),P=w(""),k=w("today"),$=w(""),V=w(""),F=w("createdAt"),M=w(!0),R=D(()=>o.isAdmin),G=D(()=>{let u=[...n.value];P.value&&(u=u.filter(H=>H.status===P.value));const s=new Date,i=new Date(s.getFullYear(),s.getMonth(),s.getDate()),x=new Date(i.getTime()-7*24*60*60*1e3),yt=new Date(i.getFullYear(),i.getMonth()-1,i.getDate());switch(k.value){case"today":u=u.filter(H=>H.createdAt>=i);break;case"week":u=u.filter(H=>H.createdAt>=x);break;case"month":u=u.filter(H=>H.createdAt>=yt);break}if($.value&&(u=u.filter(H=>H.assignedTo===$.value)),V.value){const H=V.value.toLowerCase();u=u.filter(it=>it.customer.name.toLowerCase().includes(H)||it.customer.phone.includes(H)||it.id.includes(H))}return u}),K=D(()=>[...G.value].sort((u,s)=>{let i=0;switch(F.value){case"id":i=u.id.localeCompare(s.id);break;case"createdAt":i=u.createdAt-s.createdAt;break;case"total":i=u.total-s.total;break;default:i=0}return M.value?-i:i})),_=async()=>{try{const u=lt(J(E,"orders"),$t("createdAt","desc")),s=await bt(u);n.value=s.docs.map(i=>{var x;return{id:i.id,...i.data(),createdAt:(x=i.data().createdAt)==null?void 0:x.toDate()}})}catch(u){console.error("Error fetching orders:",u)}},e=async()=>{try{const u=lt(J(E,"users"),ct("role","in",["admin","staff"])),s=await bt(u);q.value=s.docs.map(i=>({id:i.id,...i.data()}))}catch(u){console.error("Error fetching staff list:",u)}},a=u=>Z(u,"MMM d, yyyy h:mm a"),c=u=>u.toLocaleString("en-PH"),I=u=>u.length===0?"No items":u.length===1?`${u[0].name} × ${u[0].quantity}`:`${u[0].name} × ${u[0].quantity} + ${u.length-1} more`,Q=u=>{F.value===u?M.value=!M.value:(F.value=u,M.value=!0)},g=u=>F.value!==u?"fa-sort":M.value?"fa-sort-down":"fa-sort-up",r=async u=>{try{const s=nt(E,"orders",u.id);await gt(s,{status:u.status,lastUpdated:et()}),await ut(J(E,`orders/${u.id}/history`),{type:"status_change",description:`Order status changed to ${u.status}`,timestamp:et(),updatedBy:o.user.uid})}catch(s){console.error("Error updating order status:",s)}},y=async u=>{try{const s=nt(E,"orders",u.id);await gt(s,{assignedTo:u.assignedTo,lastUpdated:et()});const i=q.value.find(x=>x.id===u.assignedTo);await ut(J(E,`orders/${u.id}/history`),{type:"assignment",description:i?`Order assigned to ${i.name}`:"Order unassigned",timestamp:et(),updatedBy:o.user.uid})}catch(s){console.error("Error assigning order:",s)}},b=u=>{d.value=u},T=u=>{},rt=u=>u.status==="Pending"||u.status==="Processing",It=u=>{A.value=u,f.value=!0},Tt=async()=>{var u,s,i;if(!A.value||!C.value){alert("Please provide a cancellation reason.");return}try{const x=(u=A.value)==null?void 0:u.id;if(!x){console.error("Invalid order ID"),alert("Error: Invalid order ID");return}const yt=nt(E,"orders",x);await gt(yt,{status:"Cancelled",cancellationReason:C.value,cancelledAt:et(),cancelledBy:((s=o.user)==null?void 0:s.uid)||"system"}),await ut(J(E,`orders/${x}/history`),{type:"cancellation",description:`Order cancelled: ${C.value}`,timestamp:et(),updatedBy:((i=o.user)==null?void 0:i.uid)||"system"});const H=n.value.find(it=>it.id===x);H&&(H.status="Cancelled",H.cancellationReason=C.value),f.value=!1,C.value="",A.value=null,alert("Order cancelled successfully!")}catch(x){console.error("Error cancelling order:",x),alert("Failed to cancel order. Please try again.")}},Lt=u=>{S.value=u,h.value=!0},Rt=async()=>{if(S.value)try{const u=S.value.id;await le(nt(E,"orders",u)),n.value=n.value.filter(s=>s.id!==u),h.value=!1,S.value=null,alert("Order deleted successfully!")}catch(u){console.error("Error deleting order:",u),alert("Failed to delete order. Please try again.")}},Ut=u=>{const s=q.value.find(i=>i.id===u);return s?s.name:"Unassigned"},Vt=u=>{const s={status_change:"fas fa-sync",assignment:"fas fa-user",cancellation:"fas fa-ban",default:"fas fa-info-circle"};return s[u]||s.default};return vt(async()=>{await Promise.all([_(),e()])}),(u,s)=>(v(),p("div",Qo,[t("div",Go,[s[17]||(s[17]=t("h1",null,"Order Management",-1)),t("div",jo,[t("div",Yo,[L(t("select",{"onUpdate:modelValue":s[0]||(s[0]=i=>P.value=i)},[s[13]||(s[13]=t("option",{value:""},"All Status",-1)),(v(),p(B,null,W(m,i=>t("option",{key:i},l(i),1)),64))],512),[[j,P.value]]),L(t("select",{"onUpdate:modelValue":s[1]||(s[1]=i=>k.value=i)},s[14]||(s[14]=[t("option",{value:"today"},"Today",-1),t("option",{value:"week"},"This Week",-1),t("option",{value:"month"},"This Month",-1)]),512),[[j,k.value]]),R.value?L((v(),p("select",{key:0,"onUpdate:modelValue":s[2]||(s[2]=i=>$.value=i)},[s[15]||(s[15]=t("option",{value:""},"All Staff",-1)),(v(!0),p(B,null,W(q.value,i=>(v(),p("option",{key:i.id},l(i.name),1))),128))],512)),[[j,$.value]]):N("",!0)]),t("div",Ko,[s[16]||(s[16]=t("i",{class:"fas fa-search"},null,-1)),L(t("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=i=>V.value=i),placeholder:"Search orders..."},null,512),[[Y,V.value]])])])]),t("div",Zo,[t("table",null,[t("thead",null,[t("tr",null,[t("th",{onClick:s[4]||(s[4]=i=>Q("id"))},[s[18]||(s[18]=U(" Order # ")),t("i",{class:z(["fas",g("id")])},null,2)]),t("th",{onClick:s[5]||(s[5]=i=>Q("createdAt"))},[s[19]||(s[19]=U(" Date ")),t("i",{class:z(["fas",g("createdAt")])},null,2)]),s[21]||(s[21]=t("th",null,"Customer",-1)),s[22]||(s[22]=t("th",null,"Items",-1)),t("th",{onClick:s[6]||(s[6]=i=>Q("total"))},[s[20]||(s[20]=U(" Total ")),t("i",{class:z(["fas",g("total")])},null,2)]),s[23]||(s[23]=t("th",null,"Status",-1)),s[24]||(s[24]=t("th",null,"Assigned To",-1)),s[25]||(s[25]=t("th",null,"Actions",-1))])]),t("tbody",null,[(v(!0),p(B,null,W(K.value,i=>(v(),p("tr",{key:i.id},[t("td",null,"#"+l(i.id.slice(-6)),1),t("td",null,l(a(i.createdAt)),1),t("td",null,[t("div",Jo,[t("span",null,l(i.customer.name),1),t("span",Xo,l(i.customer.phone),1)])]),t("td",null,[t("div",tn,l(I(i.items)),1)]),t("td",null,"₱"+l(c(i.total)),1),t("td",null,[L(t("select",{"onUpdate:modelValue":x=>i.status=x,onChange:x=>r(i),class:z(["status-select",i.status])},[(v(),p(B,null,W(m,x=>t("option",{key:x,value:x},l(x),9,sn)),64))],42,en),[[j,i.status]])]),t("td",null,[R.value?L((v(),p("select",{key:0,"onUpdate:modelValue":x=>i.assignedTo=x,onChange:x=>y(i),class:"staff-select"},[s[26]||(s[26]=t("option",{value:""},"Unassigned",-1)),(v(!0),p(B,null,W(q.value,x=>(v(),p("option",{key:x.id,value:x.id},l(x.name),9,nn))),128))],40,on)),[[j,i.assignedTo]]):(v(),p("span",an,l(Ut(i.assignedTo)),1))]),t("td",null,[t("div",ln,[t("button",{onClick:x=>b(i),class:"view-btn"},s[27]||(s[27]=[t("i",{class:"fas fa-eye"},null,-1)]),8,rn),t("button",{onClick:x=>T(),class:"print-btn"},s[28]||(s[28]=[t("i",{class:"fas fa-print"},null,-1)]),8,dn),rt(i)?(v(),p("button",{key:0,onClick:x=>It(i),class:"cancel-btn"},s[29]||(s[29]=[t("i",{class:"fas fa-times"},null,-1)]),8,un)):N("",!0),R.value?(v(),p("button",{key:1,onClick:x=>Lt(i),class:"delete-btn"},s[30]||(s[30]=[t("i",{class:"fas fa-trash"},null,-1)]),8,cn)):N("",!0)])])]))),128))])])]),d.value?(v(),p("div",vn,[t("div",pn,[t("div",mn,[t("h2",null,"Order #"+l(d.value.id.slice(-6)),1),t("button",{onClick:s[7]||(s[7]=i=>d.value=null),class:"close-btn"},s[31]||(s[31]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",fn,[t("div",yn,[t("div",gn,[s[37]||(s[37]=t("h3",null,"Customer Details",-1)),t("p",null,[s[32]||(s[32]=t("strong",null,"Name:",-1)),U(" "+l(d.value.customer.name),1)]),t("p",null,[s[33]||(s[33]=t("strong",null,"Phone:",-1)),U(" "+l(d.value.customer.phone),1)]),t("p",null,[s[34]||(s[34]=t("strong",null,"Address:",-1)),U(" "+l(d.value.customer.address),1)]),t("p",null,[s[35]||(s[35]=t("strong",null,"Delivery:",-1)),U(" "+l(d.value.customer.deliveryOption),1)]),t("p",null,[s[36]||(s[36]=t("strong",null,"Payment:",-1)),U(" "+l(d.value.customer.paymentMethod),1)])]),t("div",hn,[s[41]||(s[41]=t("h3",null,"Order Items",-1)),t("div",kn,[(v(!0),p(B,null,W(d.value.items,i=>(v(),p("div",{key:i.id,class:"item"},[t("span",_n,l(i.name),1),t("span",wn,"× "+l(i.quantity),1),t("span",$n,"₱"+l(c(i.price*i.quantity)),1)]))),128))]),t("div",bn,[t("div",Cn,[s[38]||(s[38]=t("span",null,"Subtotal",-1)),t("span",null,"₱"+l(c(d.value.subtotal)),1)]),t("div",Sn,[s[39]||(s[39]=t("span",null,"Delivery Fee",-1)),t("span",null,"₱"+l(c(d.value.deliveryFee)),1)]),t("div",On,[s[40]||(s[40]=t("span",null,"Total",-1)),t("span",null,"₱"+l(c(d.value.total)),1)])])])]),t("div",An,[s[42]||(s[42]=t("h3",null,"Order History",-1)),t("div",Pn,[(v(!0),p(B,null,W(d.value.history,(i,x)=>(v(),p("div",{key:x,class:"timeline-event"},[t("div",Dn,[t("i",{class:z(Vt(i.type))},null,2)]),t("div",xn,[t("p",Mn,l(i.description),1),t("span",qn,l(a(i.timestamp)),1)])]))),128))])])])])])):N("",!0),f.value?(v(),p("div",In,[t("div",Tn,[t("div",Ln,[s[44]||(s[44]=t("h2",null,"Cancel Order",-1)),t("button",{onClick:s[8]||(s[8]=i=>f.value=!1),class:"close-btn"},s[43]||(s[43]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",Rn,[s[46]||(s[46]=t("p",null,"Are you sure you want to cancel this order?",-1)),t("div",Un,[s[45]||(s[45]=t("label",null,"Reason for Cancellation",-1)),L(t("textarea",{"onUpdate:modelValue":s[9]||(s[9]=i=>C.value=i),placeholder:"Please provide a reason...",required:""},null,512),[[Y,C.value]])]),t("div",Vn,[t("button",{onClick:s[10]||(s[10]=i=>f.value=!1),class:"cancel-btn"}," No, Keep Order "),t("button",{onClick:Tt,class:"confirm-btn"}," Yes, Cancel Order ")])])])])):N("",!0),h.value?(v(),p("div",En,[t("div",Nn,[t("div",Fn,[s[48]||(s[48]=t("h2",null,"Delete Order",-1)),t("button",{onClick:s[11]||(s[11]=i=>h.value=!1),class:"close-btn"},s[47]||(s[47]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",Bn,[s[49]||(s[49]=t("p",null,"Are you sure you want to permanently delete this order?",-1)),s[50]||(s[50]=t("p",null,"This action cannot be undone.",-1)),t("div",Wn,[t("button",{onClick:s[12]||(s[12]=i=>h.value=!1),class:"cancel-btn"}," Cancel "),t("button",{onClick:Rt,class:"confirm-btn"}," Yes, Delete Order ")])])])])):N("",!0)]))}},zn=st(Hn,[["__scopeId","data-v-d7e7c8ba"]]),Qn={class:"reports"},Gn={class:"page-header"},jn={class:"header-actions"},Yn={class:"date-range"},Kn={class:"reports-grid"},Zn={class:"report-card"},Jn={class:"card-header"},Xn={class:"period"},ta={class:"card-content"},ea={class:"summary-stats"},sa={class:"stat"},oa={class:"value"},na={class:"stat"},aa={class:"value"},la={class:"stat"},ra={class:"value"},ia={class:"report-card"},da={class:"card-header"},ua={class:"card-content"},ca={class:"products-list"},va={class:"product-info"},pa={class:"product-name"},ma={class:"product-category"},fa={class:"product-stats"},ya={class:"stat"},ga={class:"value"},ha={class:"stat"},ka={class:"value"},_a={class:"report-card"},wa={class:"card-header"},$a={class:"card-content"},ba={class:"movement-summary"},Ca={class:"summary-item"},Sa={class:"value"},Oa={class:"summary-item"},Aa={class:"value warning"},Pa={class:"summary-item"},Da={class:"value"},xa={__name:"Reports",setup(O){const o=mt(),m=w([new Date(Date.now()-30*24*60*60*1e3),new Date]),n=w("daily"),d=w(5),f=w(""),h=w(null),C=w(null);let A=null,S=null;const q=D(()=>!m.value[0]||!m.value[1]?"":`${Z(m.value[0],"MMM d, yyyy")} - ${Z(m.value[1],"MMM d, yyyy")}`),P=D(()=>o.categories),k=D(()=>{const g=xt(m.value[0]),r=re(m.value[1]);return o.dailyOrders.filter(y=>{const b=y.createdAt.toDate();return b>=g&&b<=r})}),$=D(()=>{const g=k.value,r=new Map;switch(n.value){case"daily":ue({start:m.value[0],end:m.value[1]}).forEach(y=>{const b=Z(y,"yyyy-MM-dd");r.set(b,{date:y,orders:g.filter(T=>Z(T.createdAt.toDate(),"yyyy-MM-dd")===b)})});break;case"weekly":de({start:m.value[0],end:m.value[1]}).forEach(y=>{const b=Z(y,"yyyy-[W]ww");r.set(b,{date:y,orders:g.filter(T=>Z(T.createdAt.toDate(),"yyyy-[W]ww")===b)})});break;case"monthly":ie({start:m.value[0],end:m.value[1]}).forEach(y=>{const b=Z(y,"yyyy-MM");r.set(b,{date:y,orders:g.filter(T=>Z(T.createdAt.toDate(),"yyyy-MM")===b)})});break}return r}),V=D(()=>k.value.length),F=D(()=>k.value.reduce((g,r)=>g+r.total,0)),M=D(()=>V.value?F.value/F.value:0),R=D(()=>{const g=new Map;return k.value.forEach(r=>{r.items.forEach(y=>{g.has(y.id)||g.set(y.id,{id:y.id,name:y.name,category:y.category,quantitySold:0,revenue:0});const b=g.get(y.id);b.quantitySold+=y.quantity,b.revenue+=y.price*y.quantity})}),Array.from(g.values()).sort((r,y)=>y.revenue-r.revenue).slice(0,d.value)}),G=D(()=>k.value.reduce((g,r)=>g+r.items.reduce((y,b)=>y+b.quantity,0),0)),K=D(()=>o.getLowStockCount),_=D(()=>o.inventory.reduce((g,r)=>!f.value||r.category===f.value?g+r.price*r.currentStock:g,0)),e=g=>g.toLocaleString("en-PH"),a=()=>{A&&A.destroy();const g=h.value.getContext("2d"),r=Array.from($.value.entries()).map(([y,b])=>({x:b.date,y:b.orders.reduce((T,rt)=>T+rt.total,0)}));A=new Ct(g,{type:"line",data:{datasets:[{label:"Revenue",data:r,borderColor:"#2563eb",backgroundColor:"#dbeafe",fill:!0}]},options:{responsive:!0,scales:{x:{type:"time",time:{unit:n.value==="monthly"?"month":n.value==="weekly"?"week":"day"}},y:{beginAtZero:!0}}}})},c=()=>{S&&S.destroy();const g=C.value.getContext("2d"),y=o.inventory.filter(b=>!f.value||b.category===f.value).map(b=>({x:b.name,sold:b.totalSold||0,stock:b.currentStock}));S=new Ct(g,{type:"bar",data:{labels:y.map(b=>b.x),datasets:[{label:"Current Stock",data:y.map(b=>b.stock),backgroundColor:"#dbeafe",borderColor:"#2563eb"},{label:"Sold",data:y.map(b=>b.sold),backgroundColor:"#fee2e2",borderColor:"#ef4444"}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,stacked:!1},x:{stacked:!1}}}})},I=()=>{const r=[["Report Period",q.value],["Total Orders",V.value],["Total Revenue",`₱${e(F.value)}`],["Average Order Value",`₱${e(M.value)}`],[],["Best Selling Products"],["Product Name","Category","Quantity Sold","Revenue"],...R.value.map(T=>[T.name,T.category,T.quantitySold,`₱${e(T.revenue)}`]),[],["Stock Movement"],["Product Name","Category","Current Stock","Total Sold"],...o.inventory.filter(T=>!f.value||T.category===f.value).map(T=>[T.name,T.category,T.currentStock,T.totalSold||0])].map(T=>T.join(",")).join(`
`),y=new Blob([r],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a");b.href=URL.createObjectURL(y),b.download=`report_${Z(new Date,"yyyy-MM-dd")}.csv`,b.click()},Q=()=>{const g=new ve;g.setFontSize(20),g.text("Sales and Inventory Report",20,20),g.setFontSize(12),g.text(`Period: ${q.value}`,20,30),g.setFontSize(16),g.text("Summary",20,45),g.setFontSize(12),g.text([`Total Orders: ${V.value}`,`Total Revenue: ₱${e(F.value)}`,`Average Order Value: ₱${e(M.value)}`],20,55),g.setFontSize(16),g.text("Best Selling Products",20,85),St(g,{startY:90,head:[["Product","Category","Quantity","Revenue"]],body:R.value.map(r=>[r.name,r.category,r.quantitySold,`₱${e(r.revenue)}`])}),g.addPage(),g.setFontSize(16),g.text("Stock Movement",20,20),St(g,{startY:25,head:[["Product","Category","Current Stock","Total Sold"]],body:o.inventory.filter(r=>!f.value||r.category===f.value).map(r=>[r.name,r.category,r.currentStock,r.totalSold||0])}),g.save(`report_${Z(new Date,"yyyy-MM-dd")}.pdf`)};return _t([m,n],()=>{a()}),_t([f],()=>{c()}),vt(()=>{a(),c()}),(g,r)=>(v(),p("div",Qn,[t("div",Gn,[r[7]||(r[7]=t("h1",null,"Reports",-1)),t("div",jn,[t("div",Yn,[X(dt(ce),{modelValue:m.value,"onUpdate:modelValue":r[0]||(r[0]=y=>m.value=y),range:"","enable-time-picker":!1},null,8,["modelValue"]),L(t("select",{"onUpdate:modelValue":r[1]||(r[1]=y=>n.value=y)},r[4]||(r[4]=[t("option",{value:"daily"},"Daily",-1),t("option",{value:"weekly"},"Weekly",-1),t("option",{value:"monthly"},"Monthly",-1)]),512),[[j,n.value]])]),t("div",{class:"export-actions"},[t("button",{onClick:I,class:"export-btn"},r[5]||(r[5]=[t("i",{class:"fas fa-file-csv"},null,-1),U(" Export CSV ")])),t("button",{onClick:Q,class:"export-btn"},r[6]||(r[6]=[t("i",{class:"fas fa-file-pdf"},null,-1),U(" Export PDF ")]))])])]),t("div",Kn,[t("div",Zn,[t("div",Jn,[r[8]||(r[8]=t("h2",null,"Orders Summary",-1)),t("span",Xn,l(q.value),1)]),t("div",ta,[t("canvas",{ref_key:"ordersChart",ref:h},null,512),t("div",ea,[t("div",sa,[r[9]||(r[9]=t("span",{class:"label"},"Total Orders",-1)),t("span",oa,l(V.value),1)]),t("div",na,[r[10]||(r[10]=t("span",{class:"label"},"Total Revenue",-1)),t("span",aa,"₱"+l(e(F.value)),1)]),t("div",la,[r[11]||(r[11]=t("span",{class:"label"},"Average Order Value",-1)),t("span",ra,"₱"+l(e(M.value)),1)])])])]),t("div",ia,[t("div",da,[r[13]||(r[13]=t("h2",null,"Best Selling Products",-1)),L(t("select",{"onUpdate:modelValue":r[2]||(r[2]=y=>d.value=y)},r[12]||(r[12]=[t("option",{value:"5"},"Top 5",-1),t("option",{value:"10"},"Top 10",-1),t("option",{value:"20"},"Top 20",-1)]),512),[[j,d.value]])]),t("div",ua,[t("div",ca,[(v(!0),p(B,null,W(R.value,y=>(v(),p("div",{key:y.id,class:"product-row"},[t("div",va,[t("span",pa,l(y.name),1),t("span",ma,l(y.category),1)]),t("div",fa,[t("div",ya,[r[14]||(r[14]=t("span",{class:"label"},"Sold",-1)),t("span",ga,l(y.quantitySold),1)]),t("div",ha,[r[15]||(r[15]=t("span",{class:"label"},"Revenue",-1)),t("span",ka,"₱"+l(e(y.revenue)),1)])])]))),128))])])]),t("div",_a,[t("div",wa,[r[17]||(r[17]=t("h2",null,"Stock Movement",-1)),L(t("select",{"onUpdate:modelValue":r[3]||(r[3]=y=>f.value=y)},[r[16]||(r[16]=t("option",{value:""},"All Categories",-1)),(v(!0),p(B,null,W(P.value,y=>(v(),p("option",{key:y},l(y),1))),128))],512),[[j,f.value]])]),t("div",$a,[t("canvas",{ref_key:"stockMovementChart",ref:C},null,512),t("div",ba,[t("div",Ca,[r[18]||(r[18]=t("span",{class:"label"},"Total Items Sold",-1)),t("span",Sa,l(G.value),1)]),t("div",Oa,[r[19]||(r[19]=t("span",{class:"label"},"Low Stock Items",-1)),t("span",Aa,l(K.value),1)]),t("div",Pa,[r[20]||(r[20]=t("span",{class:"label"},"Stock Value",-1)),t("span",Da,"₱"+l(e(_.value)),1)])])])])])]))}},Ma=st(xa,[["__scopeId","data-v-1acfb2a6"]]),qa=[{path:"/login",name:"Login",component:Ns,meta:{requiresAuth:!1}},{path:"/",name:"Dashboard",component:qs,meta:{requiresAuth:!0}},{path:"/catalog",name:"ProductCatalog",component:oo,meta:{requiresAuth:!0}},{path:"/orders/new",name:"OrderProcessing",component:zo,meta:{requiresAuth:!0}},{path:"/orders",name:"OrderManagement",component:zn,meta:{requiresAuth:!0}},{path:"/reports",name:"Reports",component:Ma,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/:pathMatch(.*)*",redirect:"/"}],Mt=Ht({history:zt(),routes:qa});let qt=!1;const Ia=new Promise(O=>{const o=tt.onAuthStateChanged(m=>{qt=!0,o(),O(m)})});Mt.beforeEach(async(O,o,m)=>{qt||await Ia;const n=O.matched.some(f=>f.meta.requiresAuth),d=tt.currentUser;n&&!d?m("/login"):O.path==="/login"&&d?m("/"):m()});const ft=Wt(Ne),Ta=Qt();ft.use(Mt);ft.use(Ta);ft.use(pe,{transition:"Vue-Toastification__bounce",maxToasts:3,newestOnTop:!0});ft.mount("#app");
